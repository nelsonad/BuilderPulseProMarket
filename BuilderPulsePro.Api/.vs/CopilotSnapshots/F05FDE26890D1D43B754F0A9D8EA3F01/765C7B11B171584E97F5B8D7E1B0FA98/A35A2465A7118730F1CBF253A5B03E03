using BuilderPulsePro.Api.Notifications;

namespace BuilderPulsePro.Api.Tests;

public sealed class TradeMatchingTests
{
    [Theory]
    [InlineData("plumbing", "plumbing", true)]
    [InlineData("plumbing,electrical", "plumbing", true)]
    [InlineData("plumbing,electrical", "electrical", true)]
    [InlineData("plumbing,electrical", "plumb", false)]
    [InlineData("roofing", "roof", false)]
    [InlineData("electric", "Electric", true)]
    [InlineData("", "plumbing", false)]
    [InlineData(null, "plumbing", false)]
    [InlineData("plumbing", null, false)]
    public void MatchesTradesCsv_RespectsTokenBoundaries(string? tradesCsv, string? trade, bool expected)
    {
        var result = TradeMatching.MatchesTradesCsv(tradesCsv, trade);
        Assert.Equal(expected, result);
    }

    [Theory]
    [InlineData(" Plumbing ", "plumbing")]
    [InlineData("ELECTRICAL", "electrical")]
    public void NormalizeTrade_LowercasesAndTrims(string input, string expected)
    {
        var normalized = TradeMatching.NormalizeTrade(input);
        Assert.Equal(expected, normalized);
    }
}
